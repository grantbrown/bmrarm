all_res_fast_bi <- all_res_varx(list(mod), bi = T)
} else {
all_res_fast_bi<- rbind(all_res_fast_bi, all_res_varx(list(mod), bi = T))
}
res_eta_fast_bi <- sum_res(all_res_fast_bi)
print(mean(res_eta_fast_bi$cover))
print(nrow(mod$data$data))
mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_fast_old_bi", i, ".RDS"))
mod <- list()
mod$samps <- mod1$samps$draws
mod$data <- mod1$data
if(i == first) {
all_res_fast_old_bi <- all_res_varx(list(mod), bi = T)
} else {
all_res_fast_old_bi <- rbind(all_res_fast_old_bi, all_res_varx(list(mod), bi = T))
}
res_eta_fast_old_bi <- sum_res(all_res_fast_old_bi)
print(mean(res_eta_fast_old_bi$cover))
print(nrow(mod$data$data))
cat("Interation: ", i, "\n")
}
# Proposed Model results --------------------------------------------------
first <- 1
obs <- c(1:19, 22, 24, 25, 26, 28, 29, 30, 32, 33, 35:41, 43:53, 56:250)
obs <- c(56:250)
for(i in obs){
# mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_slow", i, ".RDS"))
# mod <- list()
# mod$samps <- mod1$samps$draws
# mod$data <- mod1$data
# if(i == first) {
#   all_res <- all_res_varx(list(mod))
# } else {
#   all_res <- rbind(all_res, all_res_varx(list(mod)))
# }
#
# res_eta <- sum_res(all_res)
# print(mean(res_eta$cover))
# print(nrow(mod$data$data))
#
# mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_fast", i, ".RDS"))
# mod <- list()
# mod$samps <- mod1$samps$draws
# mod$data <- mod1$data
# if(i == first) {
#   all_res_fast <- all_res_varx(list(mod))
# } else {
#   all_res_fast <- rbind(all_res_fast, all_res_varx(list(mod)))
# }
#
# res_eta_fast <- sum_res(all_res_fast)
# print(mean(res_eta_fast$cover))
# print(nrow(mod$data$data))
#
# mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_fast_old", i, ".RDS"))
# mod <- list()
# mod$samps <- mod1$samps$draws
# mod$data <- mod1$data
# if(i == first) {
#   all_res_fast_old <- all_res_varx(list(mod))
# } else {
#   all_res_fast_old <- rbind(all_res_fast_old, all_res_varx(list(mod)))
# }
#
# res_eta_fast_old <- sum_res(all_res_fast_old)
# print(mean(res_eta_fast_old$cover))
# print(nrow(mod$data$data))
#
# mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_slow_old", i, ".RDS"))
# mod <- list()
# mod$samps <- mod1$samps$draws
# mod$data <- mod1$data
# if(i == first) {
#   all_res_slow_old <- all_res_varx(list(mod))
# } else {
#   all_res_slow_old <- rbind(all_res_slow_old, all_res_varx(list(mod)))
# }
#
# res_eta_slow_old <- sum_res(all_res_slow_old)
# print(mean(res_eta_slow_old$cover))
# print(nrow(mod$data$data))
mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_fast_bi", i, ".RDS"))
mod <- list()
mod$samps <- mod1$samps$draws
mod$data <- mod1$data
if(i == first) {
all_res_fast_bi <- all_res_varx(list(mod), bi = T)
} else {
all_res_fast_bi<- rbind(all_res_fast_bi, all_res_varx(list(mod), bi = T))
}
res_eta_fast_bi <- sum_res(all_res_fast_bi)
print(mean(res_eta_fast_bi$cover))
print(nrow(mod$data$data))
mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_fast_old_bi", i, ".RDS"))
mod <- list()
mod$samps <- mod1$samps$draws
mod$data <- mod1$data
if(i == first) {
all_res_fast_old_bi <- all_res_varx(list(mod), bi = T)
} else {
all_res_fast_old_bi <- rbind(all_res_fast_old_bi, all_res_varx(list(mod), bi = T))
}
res_eta_fast_old_bi <- sum_res(all_res_fast_old_bi)
print(mean(res_eta_fast_old_bi$cover))
print(nrow(mod$data$data))
cat("Interation: ", i, "\n")
}
obs <- c(59:250)
for(i in obs){
# mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_slow", i, ".RDS"))
# mod <- list()
# mod$samps <- mod1$samps$draws
# mod$data <- mod1$data
# if(i == first) {
#   all_res <- all_res_varx(list(mod))
# } else {
#   all_res <- rbind(all_res, all_res_varx(list(mod)))
# }
#
# res_eta <- sum_res(all_res)
# print(mean(res_eta$cover))
# print(nrow(mod$data$data))
#
# mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_fast", i, ".RDS"))
# mod <- list()
# mod$samps <- mod1$samps$draws
# mod$data <- mod1$data
# if(i == first) {
#   all_res_fast <- all_res_varx(list(mod))
# } else {
#   all_res_fast <- rbind(all_res_fast, all_res_varx(list(mod)))
# }
#
# res_eta_fast <- sum_res(all_res_fast)
# print(mean(res_eta_fast$cover))
# print(nrow(mod$data$data))
#
# mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_fast_old", i, ".RDS"))
# mod <- list()
# mod$samps <- mod1$samps$draws
# mod$data <- mod1$data
# if(i == first) {
#   all_res_fast_old <- all_res_varx(list(mod))
# } else {
#   all_res_fast_old <- rbind(all_res_fast_old, all_res_varx(list(mod)))
# }
#
# res_eta_fast_old <- sum_res(all_res_fast_old)
# print(mean(res_eta_fast_old$cover))
# print(nrow(mod$data$data))
#
# mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_slow_old", i, ".RDS"))
# mod <- list()
# mod$samps <- mod1$samps$draws
# mod$data <- mod1$data
# if(i == first) {
#   all_res_slow_old <- all_res_varx(list(mod))
# } else {
#   all_res_slow_old <- rbind(all_res_slow_old, all_res_varx(list(mod)))
# }
#
# res_eta_slow_old <- sum_res(all_res_slow_old)
# print(mean(res_eta_slow_old$cover))
# print(nrow(mod$data$data))
mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_fast_bi", i, ".RDS"))
mod <- list()
mod$samps <- mod1$samps$draws
mod$data <- mod1$data
if(i == first) {
all_res_fast_bi <- all_res_varx(list(mod), bi = T)
} else {
all_res_fast_bi<- rbind(all_res_fast_bi, all_res_varx(list(mod), bi = T))
}
res_eta_fast_bi <- sum_res(all_res_fast_bi)
print(mean(res_eta_fast_bi$cover))
print(nrow(mod$data$data))
mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_fast_old_bi", i, ".RDS"))
mod <- list()
mod$samps <- mod1$samps$draws
mod$data <- mod1$data
if(i == first) {
all_res_fast_old_bi <- all_res_varx(list(mod), bi = T)
} else {
all_res_fast_old_bi <- rbind(all_res_fast_old_bi, all_res_varx(list(mod), bi = T))
}
res_eta_fast_old_bi <- sum_res(all_res_fast_old_bi)
print(mean(res_eta_fast_old_bi$cover))
print(nrow(mod$data$data))
cat("Interation: ", i, "\n")
}
obs <- c(63:250)
for(i in obs){
# mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_slow", i, ".RDS"))
# mod <- list()
# mod$samps <- mod1$samps$draws
# mod$data <- mod1$data
# if(i == first) {
#   all_res <- all_res_varx(list(mod))
# } else {
#   all_res <- rbind(all_res, all_res_varx(list(mod)))
# }
#
# res_eta <- sum_res(all_res)
# print(mean(res_eta$cover))
# print(nrow(mod$data$data))
#
# mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_fast", i, ".RDS"))
# mod <- list()
# mod$samps <- mod1$samps$draws
# mod$data <- mod1$data
# if(i == first) {
#   all_res_fast <- all_res_varx(list(mod))
# } else {
#   all_res_fast <- rbind(all_res_fast, all_res_varx(list(mod)))
# }
#
# res_eta_fast <- sum_res(all_res_fast)
# print(mean(res_eta_fast$cover))
# print(nrow(mod$data$data))
#
# mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_fast_old", i, ".RDS"))
# mod <- list()
# mod$samps <- mod1$samps$draws
# mod$data <- mod1$data
# if(i == first) {
#   all_res_fast_old <- all_res_varx(list(mod))
# } else {
#   all_res_fast_old <- rbind(all_res_fast_old, all_res_varx(list(mod)))
# }
#
# res_eta_fast_old <- sum_res(all_res_fast_old)
# print(mean(res_eta_fast_old$cover))
# print(nrow(mod$data$data))
#
# mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_slow_old", i, ".RDS"))
# mod <- list()
# mod$samps <- mod1$samps$draws
# mod$data <- mod1$data
# if(i == first) {
#   all_res_slow_old <- all_res_varx(list(mod))
# } else {
#   all_res_slow_old <- rbind(all_res_slow_old, all_res_varx(list(mod)))
# }
#
# res_eta_slow_old <- sum_res(all_res_slow_old)
# print(mean(res_eta_slow_old$cover))
# print(nrow(mod$data$data))
mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_fast_bi", i, ".RDS"))
mod <- list()
mod$samps <- mod1$samps$draws
mod$data <- mod1$data
if(i == first) {
all_res_fast_bi <- all_res_varx(list(mod), bi = T)
} else {
all_res_fast_bi<- rbind(all_res_fast_bi, all_res_varx(list(mod), bi = T))
}
res_eta_fast_bi <- sum_res(all_res_fast_bi)
print(mean(res_eta_fast_bi$cover))
print(nrow(mod$data$data))
mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_fast_old_bi", i, ".RDS"))
mod <- list()
mod$samps <- mod1$samps$draws
mod$data <- mod1$data
if(i == first) {
all_res_fast_old_bi <- all_res_varx(list(mod), bi = T)
} else {
all_res_fast_old_bi <- rbind(all_res_fast_old_bi, all_res_varx(list(mod), bi = T))
}
res_eta_fast_old_bi <- sum_res(all_res_fast_old_bi)
print(mean(res_eta_fast_old_bi$cover))
print(nrow(mod$data$data))
cat("Interation: ", i, "\n")
}
# Proposed Model results --------------------------------------------------
first <- 1
#obs <- c(1:19, 22, 24, 25, 26, 28, 29, 30, 32, 33, 35:41, 43:53, 56:57, 59:61, 63:250)
obs <- 1:100
for(i in obs){
mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_slow_large", i, ".RDS"))
mod <- list()
mod$samps <- mod1$samps$draws
mod$data <- mod1$data
if(i == first) {
all_res <- all_res_varx(list(mod))
} else {
all_res <- rbind(all_res, all_res_varx(list(mod)))
}
res_eta <- sum_res(all_res)
print(mean(res_eta$cover))
print(nrow(mod$data$data))
mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_fast_large", i, ".RDS"))
mod <- list()
mod$samps <- mod1$samps$draws
mod$data <- mod1$data
if(i == first) {
all_res_fast <- all_res_varx(list(mod))
} else {
all_res_fast <- rbind(all_res_fast, all_res_varx(list(mod)))
}
res_eta_fast <- sum_res(all_res_fast)
print(mean(res_eta_fast$cover))
print(nrow(mod$data$data))
mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_fast_old_large", i, ".RDS"))
mod <- list()
mod$samps <- mod1$samps$draws
mod$data <- mod1$data
if(i == first) {
all_res_fast_old <- all_res_varx(list(mod))
} else {
all_res_fast_old <- rbind(all_res_fast_old, all_res_varx(list(mod)))
}
res_eta_fast_old <- sum_res(all_res_fast_old)
print(mean(res_eta_fast_old$cover))
print(nrow(mod$data$data))
mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_slow_old_large", i, ".RDS"))
mod <- list()
mod$samps <- mod1$samps$draws
mod$data <- mod1$data
if(i == first) {
all_res_slow_old <- all_res_varx(list(mod))
} else {
all_res_slow_old <- rbind(all_res_slow_old, all_res_varx(list(mod)))
}
res_eta_slow_old <- sum_res(all_res_slow_old)
print(mean(res_eta_slow_old$cover))
print(nrow(mod$data$data))
# mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_fast_bi_large", i, ".RDS"))
# mod <- list()
# mod$samps <- mod1$samps$draws
# mod$data <- mod1$data
# if(i == first) {
#   all_res_fast_bi <- all_res_varx(list(mod), bi = T)
# } else {
#   all_res_fast_bi<- rbind(all_res_fast_bi, all_res_varx(list(mod), bi = T))
# }
#
# res_eta_fast_bi <- sum_res(all_res_fast_bi)
# print(mean(res_eta_fast_bi$cover))
# print(nrow(mod$data$data))
#
# mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_fast_old_bi_large", i, ".RDS"))
# mod <- list()
# mod$samps <- mod1$samps$draws
# mod$data <- mod1$data
# if(i == first) {
#   all_res_fast_old_bi <- all_res_varx(list(mod), bi = T)
# } else {
#   all_res_fast_old_bi <- rbind(all_res_fast_old_bi, all_res_varx(list(mod), bi = T))
# }
#
# res_eta_fast_old_bi <- sum_res(all_res_fast_old_bi)
# print(mean(res_eta_fast_old_bi$cover))
# print(nrow(mod$data$data))
cat("Interation: ", i, "\n")
}
setwd("C:\\Users\\Nick\\Dropbox\\_Thesis\\bmrvar\\long_sims")
source("../run_apps_sims//helper_functions.R")
# Proposed Model results --------------------------------------------------
first <- 1
#obs <- c(1:19, 22, 24, 25, 26, 28, 29, 30, 32, 33, 35:41, 43:53, 56:57, 59:61, 63:250)
obs <- 1:100
for(i in obs){
mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_slow_large", i, ".RDS"))
mod <- list()
mod$samps <- mod1$samps$draws
mod$data <- mod1$data
if(i == first) {
all_res <- all_res_varx(list(mod))
} else {
all_res <- rbind(all_res, all_res_varx(list(mod)))
}
res_eta <- sum_res(all_res)
print(mean(res_eta$cover))
print(nrow(mod$data$data))
mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_fast_large", i, ".RDS"))
mod <- list()
mod$samps <- mod1$samps$draws
mod$data <- mod1$data
if(i == first) {
all_res_fast <- all_res_varx(list(mod))
} else {
all_res_fast <- rbind(all_res_fast, all_res_varx(list(mod)))
}
res_eta_fast <- sum_res(all_res_fast)
print(mean(res_eta_fast$cover))
print(nrow(mod$data$data))
mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_fast_old_large", i, ".RDS"))
mod <- list()
mod$samps <- mod1$samps$draws
mod$data <- mod1$data
if(i == first) {
all_res_fast_old <- all_res_varx(list(mod))
} else {
all_res_fast_old <- rbind(all_res_fast_old, all_res_varx(list(mod)))
}
res_eta_fast_old <- sum_res(all_res_fast_old)
print(mean(res_eta_fast_old$cover))
print(nrow(mod$data$data))
mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_slow_old_large", i, ".RDS"))
mod <- list()
mod$samps <- mod1$samps$draws
mod$data <- mod1$data
if(i == first) {
all_res_slow_old <- all_res_varx(list(mod))
} else {
all_res_slow_old <- rbind(all_res_slow_old, all_res_varx(list(mod)))
}
res_eta_slow_old <- sum_res(all_res_slow_old)
print(mean(res_eta_slow_old$cover))
print(nrow(mod$data$data))
# mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_fast_bi_large", i, ".RDS"))
# mod <- list()
# mod$samps <- mod1$samps$draws
# mod$data <- mod1$data
# if(i == first) {
#   all_res_fast_bi <- all_res_varx(list(mod), bi = T)
# } else {
#   all_res_fast_bi<- rbind(all_res_fast_bi, all_res_varx(list(mod), bi = T))
# }
#
# res_eta_fast_bi <- sum_res(all_res_fast_bi)
# print(mean(res_eta_fast_bi$cover))
# print(nrow(mod$data$data))
#
# mod1 <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_samples\\bmrvarx_sim_fast_old_bi_large", i, ".RDS"))
# mod <- list()
# mod$samps <- mod1$samps$draws
# mod$data <- mod1$data
# if(i == first) {
#   all_res_fast_old_bi <- all_res_varx(list(mod), bi = T)
# } else {
#   all_res_fast_old_bi <- rbind(all_res_fast_old_bi, all_res_varx(list(mod), bi = T))
# }
#
# res_eta_fast_old_bi <- sum_res(all_res_fast_old_bi)
# print(mean(res_eta_fast_old_bi$cover))
# print(nrow(mod$data$data))
cat("Interation: ", i, "\n")
}
remotes::install_github("nickseedorff/bmrarm")
library(magrittr)
library(dplyr)
library(ggplot2)
library(gridExtra)
library(tidyr)
library(coda)
library(devtools)
library(astsa)
#remotes::install_github("nickseedorff/bmrarm")
library(bmrarm)
setwd("C:\\Users\\Nick\\Dropbox\\_Thesis\\bmrvar\\long_sims")
source("../run_apps_sims//helper_functions.R")
part_ord <- ntile(part, 3)
tempr_ord <- ntile(tempr, 2)
full_data <- data.frame(part, tempr, cmort, part_ord, tempr_ord,
lag_cmort = lag(as.vector(cmort)),
time = 1:length(tempr_ord))
res_brm <- res <- res_dis <- res_varx <- matrix(NA, nrow = 154, ncol = 20)
for(i in 350:488) {
## Model using true values
mod <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_final_samples\\app_bmrvarx", i, ".RDS"))
max_time <- max(mod$data$time)
max_1 <- max_time + 1
max_5 <- max_time + 20
preds <- bmrarm:::get_preds(bmrvarx_obj = mod$samps, steps_ahead = 20,
X = matrix(max_1:max_5, ncol = 1))
res_varx[i - 349, ] <- (colMeans(preds$cont_preds_last) - full_data$cmort[max_1:max_5]) ^ 2
## Model using true values
mod <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_final_samples\\app_bvar_discrete", i, ".RDS"))
max_time <- max(mod$data$time)
check <- matrix(rep(as.numeric(mod$data[length(mod$data$part), c(4, 5, 3)]), each = 2000), nrow = 3, byrow = T)
mod$samps$data_for_forecasts[[1]] <- check
preds <- bmrarm:::get_preds(bmrvarx_obj = mod$samps, steps_ahead = 20,
X = matrix(max_1:max_5, ncol = 1))
res_dis[i - 349, ] <- (colMeans(preds$cont_preds_last) - full_data$cmort[max_1:max_5]) ^ 2
## Model using true values
mod <- readRDS(paste0("Z:\\bmrarm\\bmrvarx_final_samples\\app_bvar_true", i, ".RDS"))
max_time <- max(mod$data$time)
check <- matrix(rep(as.numeric(mod$data[length(mod$data$part), 1:3]), each = 2000), nrow = 3, byrow = T)
mod$samps$data_for_forecasts[[1]] <- check
preds <- bmrarm:::get_preds(bmrvarx_obj = mod$samps, steps_ahead = 20,
X = matrix(max_1:max_5, ncol = 1))
res[i - 349, ] <- (colMeans(preds$cont_preds_last) - full_data$cmort[max_1:max_5]) ^ 2
##brms model
brm_tmp <- readRDS(paste0("./app_brms", i, ".RDS"))
res_brm[i - 349, ] <- brm_tmp$preds$sq_error
print(i)
}
colMeans(res_varx, na.rm = T)
colMeans(res_dis, na.rm = T)
colMeans(res, na.rm = T)
colMeans(res_brm, na.rm = T)
colMeans(preds$cont_preds_last)
install.packages("bsts")
library(bsts)
data(iclaims)
initial.claims
data(new.home.sales)
new.home.sales
data(sharks)
data(shark)
shark
data("turkish")
turkish
install.packages("car")
library(car)
summary(KosteckiDillon)
KosteckiDillon
dat <- KosteckiDillon
View(dat)
table(dat$id)
max(table(dat$id))
