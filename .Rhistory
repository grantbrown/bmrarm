lines(density(mcmc(mod_list[[2]]$samps$res_cuts[4, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_cuts[4, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_cuts[4, ])), col = 4, lwd = 3)
legend("topright", legend = c("Chain 1", "Chain 2", "Chain 3", "Chain 4"),
lty = 1, col = 1:4, cex = 1.2, lwd = 3)
plot(mod_list[[1]]$samps$res_cuts[5, ], type = "l",
ylab = expression(gamma[4]), main = expression("Traceplot: " ~ gamma[4]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_cuts[5, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_cuts[5, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_cuts[5, ]), col = 4)
text(3350, 2.15, "GR Upper CI = 1.01", cex = 1.2)
max_dens <- max(c(density(mod_list[[1]]$samps$res_cuts[5, ])$y,
density(mod_list[[2]]$samps$res_cuts[5, ])$y,
density(mod_list[[3]]$samps$res_cuts[5, ])$y))
plot(density(mod_list[[1]]$samps$res_cuts[5, ]), type = "l", lwd = 3,
ylab = expression(gamma[4]), ylim = c(0, max_dens),
main = expression("Posterior Density: " ~ gamma[4]))
lines(density(mcmc(mod_list[[2]]$samps$res_cuts[5, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_cuts[5, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_cuts[5, ])), col = 4, lwd = 3)
legend("topright", legend = c("Chain 1", "Chain 2", "Chain 3", "Chain 4"),
lty = 1, col = 1:4, cex = 1.2, lwd = 3)
par(mfrow=c(3,2))
plot(mod_list[[1]]$samps$res_sigma[1, ], type = "l",
ylab = expression(R[11]), main = expression("Traceplot: " ~ R[11]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_sigma[1, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_sigma[1, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_sigma[1, ]), col = 4)
text(3350, 0.625, "GR Upper CI = 1.01", cex = 1.2)
max_dens <- max(c(density(mod_list[[4]]$samps$res_sigma[1, ])$y,
density(mod_list[[2]]$samps$res_sigma[1, ])$y,
density(mod_list[[3]]$samps$res_sigma[1, ])$y))
plot(density(mod_list[[1]]$samps$res_sigma[1, ]), type = "l", lwd = 3,
ylab = expression(R[11]), ylim = c(0, max_dens),
main = expression("Posterior Density: " ~ R[11]))
lines(density(mcmc(mod_list[[2]]$samps$res_sigma[1, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_sigma[1, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_sigma[1, ])), col = 4, lwd = 3)
legend("topright", legend = c("Chain 1", "Chain 2", "Chain 3", "Chain 4"),
lty = 1, col = 1:4, cex = 1.2, lwd = 3)
max_dens <- max(c(density(mod_list[[4]]$samps$res_pat_sig[1, ])$y,
density(mod_list[[2]]$samps$res_pat_sig[1, ])$y,
density(mod_list[[3]]$samps$res_pat_sig[1, ])$y,
density(mod_list[[1]]$samps$res_pat_sig[1, ])$y))
plot(mod_list[[1]]$samps$res_pat_sig[1, ], type = "l",
ylab = expression(Sigma[alpha][11]), main = expression("Traceplot: " ~ Sigma[alpha][11]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_pat_sig[1, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_pat_sig[1, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_pat_sig[1, ]), col = 4)
text(3350, 0.605, "GR Upper CI = 1.01", cex = 1.2)
plot(density(mod_list[[1]]$samps$res_pat_sig[1, ]), type = "l", lwd = 3,
ylab = expression(Sigma[alpha][11]), ylim = c(0, max_dens),
main = expression("Posterior Density: " ~ Sigma[alpha][11]))
lines(density(mcmc(mod_list[[2]]$samps$res_pat_sig[1, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_pat_sig[1, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_pat_sig[1, ])), col = 4, lwd = 3)
legend("topright", legend = c("Chain 1", "Chain 2", "Chain 3", "Chain 4"),
lty = 1, col = 1:4, cex = 1.2, lwd = 3)
max_dens <- max(c(density(mod_list[[4]]$samps$res_pat_sig[6, ])$y,
density(mod_list[[2]]$samps$res_pat_sig[6, ])$y,
density(mod_list[[3]]$samps$res_pat_sig[6, ])$y))
plot(mod_list[[1]]$samps$res_pat_sig[6, ], type = "l",
ylab = expression(Sigma[alpha][22]), main = expression("Traceplot: " ~ Sigma[alpha][22]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_pat_sig[6, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_pat_sig[6, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_pat_sig[6, ]), col = 4)
text(3350, 0.245, "GR Upper CI = 1.01", cex = 1.2)
plot(density(mod_list[[1]]$samps$res_pat_sig[6, ]), type = "l", lwd = 3,
ylab = expression(Sigma[alpha][22]), ylim = c(0, max_dens),
main = expression("Posterior Density: " ~ Sigma[alpha][22]))
lines(density(mcmc(mod_list[[2]]$samps$res_pat_sig[6, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_pat_sig[6, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_pat_sig[6, ])), col = 4, lwd = 3)
legend("topright", legend = c("Chain 1", "Chain 2", "Chain 3", "Chain 4"),
lty = 1, col = 1:4, cex = 1.2, lwd = 3)
max_dens <- max(c(density(mod_list[[4]]$samps$res_pat_sig[11, ])$y,
density(mod_list[[2]]$samps$res_pat_sig[11, ])$y,
density(mod_list[[3]]$samps$res_pat_sig[11, ])$y))
plot(mod_list[[1]]$samps$res_pat_sig[11, ], type = "l",
ylab = expression(Sigma[alpha][11]), main = expression("Traceplot: " ~ Sigma[alpha][11]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_pat_sig[11, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_pat_sig[11, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_pat_sig[11, ]), col = 4)
text(3350, 0.635, "GR Upper CI = 1.00", cex = 1.2)
plot(density(mod_list[[1]]$samps$res_pat_sig[11, ]), type = "l", lwd = 3,
ylab = expression(Sigma[alpha][11]), ylim = c(0, max_dens),
main = expression("Posterior Density: " ~ Sigma[alpha][11]))
lines(density(mcmc(mod_list[[2]]$samps$res_pat_sig[11, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_pat_sig[11, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_pat_sig[11, ])), col = 4, lwd = 3)
legend("topright", legend = c("Chain 1", "Chain 2", "Chain 3", "Chain 4"),
lty = 1, col = 1:4, cex = 1.2, lwd = 3)
max_dens <- max(c(density(mod_list[[4]]$samps$res_pat_sig[16, ])$y,
density(mod_list[[2]]$samps$res_pat_sig[16, ])$y,
density(mod_list[[3]]$samps$res_pat_sig[16, ])$y))
plot(mod_list[[1]]$samps$res_pat_sig[16, ], type = "l",
ylab = expression(Sigma[alpha][16]), main = expression("Traceplot: " ~ Sigma[alpha][11]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_pat_sig[16, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_pat_sig[16, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_pat_sig[16, ]), col = 4)
text(3350, 0.635, "GR Upper CI = 1.00", cex = 1.2)
plot(density(mod_list[[1]]$samps$res_pat_sig[16, ]), type = "l", lwd = 3,
ylab = expression(Sigma[alpha][16]), ylim = c(0, max_dens),
main = expression("Posterior Density: " ~ Sigma[alpha][16]))
lines(density(mcmc(mod_list[[2]]$samps$res_pat_sig[16, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_pat_sig[16, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_pat_sig[16, ])), col = 4, lwd = 3)
legend("topright", legend = c("Chain 1", "Chain 2", "Chain 3", "Chain 4"),
lty = 1, col = 1:4, cex = 1.2, lwd = 3)
# Make table of posterior estimates ---------------------------------------
mcmc_summ <- function(x) {
summ <- summary(mcmc(x))
c(summ[[1]][1], summ[[1]][2], summ[[2]][1], summ[[2]][5],effectiveSize(mcmc(x)))
}
gamma3 <- t(sapply(1:4, function(x) mcmc_summ(mod_list[[x]]$samps$res_cuts[4, ])))
gamma4 <- t(sapply(1:4, function(x) mcmc_summ(mod_list[[x]]$samps$res_cuts[5, ])))
sig11 <- t(sapply(1:4, function(x) mcmc_summ(mod_list[[x]]$samps$res_sigma[1, ])))
sig_alpha11 <- t(sapply(1:4, function(x) mcmc_summ(mod_list[[x]]$samps$res_pat_sig[1, ])))
sig_alpha22 <- t(sapply(1:4, function(x) mcmc_summ(mod_list[[x]]$samps$res_pat_sig[6, ])))
full_tab_res <- rbind(gamma3, gamma4, sig11, sig_alpha11, sig_alpha22)
df <- data.frame(param = c("gamma3", rep("", 3), "gamm4", rep("", 3),
"sig11", rep("", 3), "sig_alpha11", rep("", 3),
"sig_alpha22", rep("", 3)),
chain = rep(1:4, 5), full_tab_res,
gelman_rubin = c("1.010", rep("", 3), "1.015", rep("", 3),
"1.008", rep("", 3), "1.006", rep("", 3),
"1.012", rep("", 3)))
View(df)
table(mod_list[[1]]$data$data$y_ord)
sample(1:400, 1)
sample(1:400, 1)
## Collect objects
max_mod <- 4
mod_list <- list()
obs <- c(1:max_mod)
for(i in 1:length(obs)){
mod_list[[i]] <- readRDS(paste0("Z:\\final_bmrarm\\bmrarm_samples\\leish_data_int_model", i, ".RDS"))
print(mod_list[[i]]$runtime)
}
setwd("C:\\Users\\Nick\\Dropbox\\_Thesis\\bmrvar\\long_sims")
source("../run_apps_sims//helper_functions.R")
## Collect objects
max_mod <- 4
mod_list <- list()
obs <- c(1:max_mod)
for(i in 1:length(obs)){
mod_list[[i]] <- readRDS(paste0("Z:\\final_bmrarm\\bmrarm_samples\\leish_data_int_model", i, ".RDS"))
print(mod_list[[i]]$runtime)
}
## Collect objects
max_mod <- 4
mod_list <- list()
obs <- c(1:max_mod)
for(i in 1:length(obs)){
mod_list[[i]] <- readRDS(paste0("Z:\\final_bmrarm\\bmrarm_samples\\leish_data_int_model_siw", i, ".RDS"))
print(mod_list[[i]]$runtime)
}
setwd("C:\\Users\\Nick\\Dropbox\\_Thesis\\bmrvar\\long_sims")
source("../run_apps_sims//helper_functions.R")
## Collect objects
max_mod <- 4
mod_list <- list()
obs <- c(1:max_mod)
for(i in 1:length(obs)){
mod_list[[i]] <- readRDS(paste0("Z:\\final_bmrarm\\bmrarm_samples\\leish_data_int_model_siw", i, ".RDS"))
print(mod_list[[i]]$runtime)
}
## Collect objects
max_mod <- 4
mod_list <- list()
obs <- c(1:max_mod)
obs <- c(1:4)
for(i in 1:length(obs)){
mod_list[[i]] <- readRDS(paste0("Z:\\final_bmrarm\\bmrarm_samples\\ar_model_same_data255", obs[i], ".RDS"))
mod_list[[i]]$samps <- mod_list[[i]]$samps$draws
#mod_list[[i]]$samps$res_pat_sig <- mod_list[[i]]$samps$res_pat_sig_q
print(mod_list[[i]]$runtime)
#print(effectiveSize(mcmc(mod_list[[i]]$samps$res_cuts[4, ])))
}
par(mfrow=c(2,2))
plot(mod_list[[1]]$samps$res_cuts[4, ], type = "l",
ylab = expression(gamma[3]), main = expression("Traceplot: " ~ gamma[3]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_cuts[4, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_cuts[4, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_cuts[4, ]), col = 4)
text(3350, 1.72, "GR Upper CI = 1.01", cex = 1.2)
max_dens <- max(c(density(mod_list[[1]]$samps$res_cuts[4, ])$y,
density(mod_list[[2]]$samps$res_cuts[4, ])$y,
density(mod_list[[3]]$samps$res_cuts[4, ])$y))
plot(density(mod_list[[1]]$samps$res_cuts[4, ]), type = "l", lwd = 3,
ylab = expression(gamma[3]), ylim = c(0, max_dens),
main = expression("Posterior Density: " ~ gamma[3]))
lines(density(mcmc(mod_list[[2]]$samps$res_cuts[4, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_cuts[4, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_cuts[4, ])), col = 4, lwd = 3)
legend("topright", legend = c("Chain 1", "Chain 2", "Chain 3", "Chain 4"),
lty = 1, col = 1:4, cex = 1.2, lwd = 3)
plot(mod_list[[1]]$samps$res_cuts[5, ], type = "l",
ylab = expression(gamma[4]), main = expression("Traceplot: " ~ gamma[4]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_cuts[5, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_cuts[5, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_cuts[5, ]), col = 4)
text(3350, 2.15, "GR Upper CI = 1.01", cex = 1.2)
max_dens <- max(c(density(mod_list[[1]]$samps$res_cuts[5, ])$y,
density(mod_list[[2]]$samps$res_cuts[5, ])$y,
density(mod_list[[3]]$samps$res_cuts[5, ])$y))
plot(density(mod_list[[1]]$samps$res_cuts[5, ]), type = "l", lwd = 3,
ylab = expression(gamma[4]), ylim = c(0, max_dens),
main = expression("Posterior Density: " ~ gamma[4]))
lines(density(mcmc(mod_list[[2]]$samps$res_cuts[5, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_cuts[5, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_cuts[5, ])), col = 4, lwd = 3)
legend("topright", legend = c("Chain 1", "Chain 2", "Chain 3", "Chain 4"),
lty = 1, col = 1:4, cex = 1.2, lwd = 3)
par(mfrow=c(3,2))
plot(mod_list[[1]]$samps$res_sigma[1, ], type = "l",
ylab = expression(R[11]), main = expression("Traceplot: " ~ R[11]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_sigma[1, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_sigma[1, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_sigma[1, ]), col = 4)
text(3350, 0.625, "GR Upper CI = 1.01", cex = 1.2)
max_dens <- max(c(density(mod_list[[4]]$samps$res_sigma[1, ])$y,
density(mod_list[[2]]$samps$res_sigma[1, ])$y,
density(mod_list[[3]]$samps$res_sigma[1, ])$y))
plot(density(mod_list[[1]]$samps$res_sigma[1, ]), type = "l", lwd = 3,
ylab = expression(R[11]), ylim = c(0, max_dens),
main = expression("Posterior Density: " ~ R[11]))
lines(density(mcmc(mod_list[[2]]$samps$res_sigma[1, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_sigma[1, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_sigma[1, ])), col = 4, lwd = 3)
legend("topright", legend = c("Chain 1", "Chain 2", "Chain 3", "Chain 4"),
lty = 1, col = 1:4, cex = 1.2, lwd = 3)
max_dens <- max(c(density(mod_list[[4]]$samps$res_pat_sig[1, ])$y,
density(mod_list[[2]]$samps$res_pat_sig[1, ])$y,
density(mod_list[[3]]$samps$res_pat_sig[1, ])$y,
density(mod_list[[1]]$samps$res_pat_sig[1, ])$y))
plot(mod_list[[1]]$samps$res_pat_sig[1, ], type = "l",
ylab = expression(Sigma[alpha][11]), main = expression("Traceplot: " ~ Sigma[alpha][11]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_pat_sig[1, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_pat_sig[1, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_pat_sig[1, ]), col = 4)
text(3350, 0.605, "GR Upper CI = 1.01", cex = 1.2)
plot(density(mod_list[[1]]$samps$res_pat_sig[1, ]), type = "l", lwd = 3,
ylab = expression(Sigma[alpha][11]), ylim = c(0, max_dens),
main = expression("Posterior Density: " ~ Sigma[alpha][11]))
lines(density(mcmc(mod_list[[2]]$samps$res_pat_sig[1, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_pat_sig[1, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_pat_sig[1, ])), col = 4, lwd = 3)
legend("topright", legend = c("Chain 1", "Chain 2", "Chain 3", "Chain 4"),
lty = 1, col = 1:4, cex = 1.2, lwd = 3)
max_dens <- max(c(density(mod_list[[4]]$samps$res_pat_sig[6, ])$y,
density(mod_list[[2]]$samps$res_pat_sig[6, ])$y,
density(mod_list[[3]]$samps$res_pat_sig[6, ])$y))
plot(mod_list[[1]]$samps$res_pat_sig[6, ], type = "l",
ylab = expression(Sigma[alpha][22]), main = expression("Traceplot: " ~ Sigma[alpha][22]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_pat_sig[6, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_pat_sig[6, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_pat_sig[6, ]), col = 4)
text(3350, 0.245, "GR Upper CI = 1.01", cex = 1.2)
plot(density(mod_list[[1]]$samps$res_pat_sig[6, ]), type = "l", lwd = 3,
ylab = expression(Sigma[alpha][22]), ylim = c(0, max_dens),
main = expression("Posterior Density: " ~ Sigma[alpha][22]))
lines(density(mcmc(mod_list[[2]]$samps$res_pat_sig[6, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_pat_sig[6, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_pat_sig[6, ])), col = 4, lwd = 3)
legend("topright", legend = c("Chain 1", "Chain 2", "Chain 3", "Chain 4"),
lty = 1, col = 1:4, cex = 1.2, lwd = 3)
gelman.diag(mcmc.list(mcmc(mod_list[[1]]$samps$res_cuts[4, ]),
mcmc(mod_list[[2]]$samps$res_cuts[4, ]),
mcmc(mod_list[[3]]$samps$res_cuts[4, ]),
mcmc(mod_list[[4]]$samps$res_cuts[4, ])))[[1]][, 2]
gelman.diag(mcmc.list(mcmc(mod_list[[1]]$samps$res_cuts[5, ]),
mcmc(mod_list[[2]]$samps$res_cuts[5, ]),
mcmc(mod_list[[3]]$samps$res_cuts[5, ]),
mcmc(mod_list[[4]]$samps$res_cuts[5, ])))[[1]][, 2]
max(gelman.diag(mcmc.list(mcmc(t(mod_list[[1]]$samps$res_beta)),
mcmc(t(mod_list[[2]]$samps$res_beta)),
mcmc(t(mod_list[[3]]$samps$res_beta)),
mcmc(t(mod_list[[4]]$samps$res_beta))))[[1]][, 2])
max(gelman.diag(mcmc.list(mcmc(t(mod_list[[1]]$samps$res_pat_sig[c(1, 6, 11, 16), ])),
mcmc(t(mod_list[[2]]$samps$res_pat_sig[c(1, 6, 11, 16), ])),
mcmc(t(mod_list[[3]]$samps$res_pat_sig[c(1, 6, 11, 16), ])),
mcmc(t(mod_list[[4]]$samps$res_pat_sig[c(1, 6, 11, 16), ]))))[[1]][, 2])
gelman.diag(mcmc.list(mcmc(mod_list[[1]]$samps$res_cuts[4, ]),
mcmc(mod_list[[2]]$samps$res_cuts[4, ]),
mcmc(mod_list[[3]]$samps$res_cuts[4, ]),
mcmc(mod_list[[4]]$samps$res_cuts[4, ])))[[1]][, 2]
gelman.diag(mcmc.list(mcmc(mod_list[[1]]$samps$res_cuts[5, ]),
mcmc(mod_list[[2]]$samps$res_cuts[5, ]),
mcmc(mod_list[[3]]$samps$res_cuts[5, ]),
mcmc(mod_list[[4]]$samps$res_cuts[5, ])))[[1]][, 2]
max(gelman.diag(mcmc.list(mcmc(t(mod_list[[1]]$samps$res_pat_sig[c(1, 6, 11, 16), ])),
mcmc(t(mod_list[[2]]$samps$res_pat_sig[c(1, 6, 11, 16), ])),
mcmc(t(mod_list[[3]]$samps$res_pat_sig[c(1, 6, 11, 16), ])),
mcmc(t(mod_list[[4]]$samps$res_pat_sig[c(1, 6, 11, 16), ]))))[[1]][, 2])
max(gelman.diag(mcmc.list(mcmc(t(mod_list[[1]]$samps$res_sigma)),
mcmc(t(mod_list[[2]]$samps$res_sigma)),
mcmc(t(mod_list[[3]]$samps$res_sigma)),
mcmc(t(mod_list[[4]]$samps$res_sigma))), multivariate = F)[[1]][, 2])
gelman.diag(mcmc.list(mcmc(t(mod_list[[1]]$samps$res_cuts)),
mcmc(t(mod_list[[2]]$samps$res_cuts)),
mcmc(t(mod_list[[3]]$samps$res_cuts)),
mcmc(t(mod_list[[4]]$samps$res_cuts))), multivariate = F)[[1]]
gelman.diag(mcmc.list(mcmc(t(mod_list[[1]]$samps$res_sigma)),
mcmc(t(mod_list[[2]]$samps$res_sigma)),
mcmc(t(mod_list[[3]]$samps$res_sigma)),
mcmc(t(mod_list[[4]]$samps$res_sigma))), multivariate = F)[[1]]
gelman.diag(mcmc.list(mcmc(t(mod_list[[1]]$samps$res_pat_sig)),
mcmc(t(mod_list[[2]]$samps$res_pat_sig)),
mcmc(t(mod_list[[3]]$samps$res_pat_sig)),
mcmc(t(mod_list[[4]]$samps$res_pat_sig))), multivariate = F)[[1]]
gelman.diag(mcmc.list(mcmc(t(mod_list[[1]]$samps$res_pat_eff[,1,])),
mcmc(t(mod_list[[2]]$samps$res_pat_eff[,1,])),
mcmc(t(mod_list[[3]]$samps$res_pat_eff[,1,])),
mcmc(t(mod_list[[4]]$samps$res_pat_eff[,1,]))), multivariate = T)
gelman.diag(mcmc.list(mcmc(t(mod_list[[1]]$samps$res_pat_eff[,3,])),
mcmc(t(mod_list[[2]]$samps$res_pat_eff[,3,])),
mcmc(t(mod_list[[3]]$samps$res_pat_eff[,3,])),
mcmc(t(mod_list[[4]]$samps$res_pat_eff[,3,]))), multivariate = T)
gelman.diag(mcmc.list(mcmc(t(mod_list[[1]]$samps$res_pat_eff[,2,])),
mcmc(t(mod_list[[2]]$samps$res_pat_eff[,2,])),
mcmc(t(mod_list[[3]]$samps$res_pat_eff[,2,])),
mcmc(t(mod_list[[4]]$samps$res_pat_eff[,2,]))), multivariate = T)
gelman.diag(mcmc.list(mcmc(t(mod_list[[1]]$samps$res_pat_eff[,4,])),
mcmc(t(mod_list[[2]]$samps$res_pat_eff[,4,])),
mcmc(t(mod_list[[3]]$samps$res_pat_eff[,4,])),
mcmc(t(mod_list[[4]]$samps$res_pat_eff[,4,]))), multivariate = T)
gelman.diag(mcmc.list(mcmc(t(mod_list[[1]]$samps$res_y[,1,])),
mcmc(t(mod_list[[2]]$samps$res_y[,1,])),
mcmc(t(mod_list[[3]]$samps$res_y[,1,])),
mcmc(t(mod_list[[4]]$samps$res_y[,1,]))), multivariate = F)
max(gelman.diag(mcmc.list(mcmc(t(mod_list[[1]]$samps$res_y[,1,])),
mcmc(t(mod_list[[2]]$samps$res_y[,1,])),
mcmc(t(mod_list[[3]]$samps$res_y[,1,])),
mcmc(t(mod_list[[4]]$samps$res_y[,1,]))), multivariate = F)[[1]][, 2])
## Collect objects
max_mod <- 4
mod_list <- list()
obs <- c(1:max_mod)
for(i in 1:length(obs)){
mod_list[[i]] <- readRDS(paste0("Z:\\final_bmrarm\\bmrarm_samples\\leish_data_ar_model", i, ".RDS"))
mod_list[[i]]$samps <- mod_list[[i]]$samps$draws
print(mod_list[[i]]$runtime)
}
mcmc_summ <- function(x) {
summ <- summary(mcmc(x))
c(paste0(round(summ[[1]][1], 3), " (", round(summ[[1]][2], 3), ")"),
paste0("(", round(summ[[2]][1], 3), ", ", round(summ[[2]][5], 3), ")"))
}
library(xtable)
full_mod <- mod_list[[1]]$samps
## Combined into a single model for DIC
full_mod$res_beta <- cbind(mod_list[[1]]$samps$res_beta,
mod_list[[2]]$samps$res_beta,
mod_list[[3]]$samps$res_beta,
mod_list[[4]]$samps$res_beta)
full_mod$res_pat_sig <- cbind(mod_list[[1]]$samps$res_pat_sig,
mod_list[[2]]$samps$res_pat_sig,
mod_list[[3]]$samps$res_pat_sig,
mod_list[[4]]$samps$res_pat_sig)
full_mod$res_sigma <- cbind(mod_list[[1]]$samps$res_sigma,
mod_list[[2]]$samps$res_sigma,
mod_list[[3]]$samps$res_sigma,
mod_list[[4]]$samps$res_sigma)
full_mod$res_cuts <- cbind(mod_list[[1]]$samps$res_cuts,
mod_list[[2]]$samps$res_cuts,
mod_list[[3]]$samps$res_cuts,
mod_list[[4]]$samps$res_cuts)
full_mod$res_ar <- c(mod_list[[1]]$samps$res_ar, mod_list[[2]]$samps$res_ar,
mod_list[[3]]$samps$res_ar, mod_list[[4]]$samps$res_ar)
full_mod$res_y <- abind::abind(mod_list[[1]]$samps$res_y,
mod_list[[2]]$samps$res_y,
mod_list[[3]]$samps$res_y,
mod_list[[4]]$samps$res_y, along = 3)
full_mod$res_pat_eff <- abind::abind(mod_list[[1]]$samps$res_pat_eff,
mod_list[[2]]$samps$res_pat_eff,
mod_list[[3]]$samps$res_pat_eff,
mod_list[[4]]$samps$res_pat_eff, along = 3)
df_tab <- data.frame(outcome = c(rep("Ordinal", 13),
rep("Continuous", 11),
rep("Shared", 5)),
param = c("$\\beta_{intercept}$",
"$\\beta_{treatment}$",
"$\\beta_{time}$",
"$\\beta_{[age\\ge 3]}$",
"$\\beta_{log(dpp)}$",
"$\\beta_{[Hunt= M]}$",
"$\\beta_{[Hunt = W]}$",
"$R_{11}$",
"$\\Sigma_{\\alpha 11}$",
"$\\frac{\\Sigma_{\\alpha 12}}{\\sqrt{\\Sigma_{\\alpha 11}\\Sigma_{\\alpha 22}}}$",
"$\\Sigma_{\\alpha 22}$",
"$\\rho$",
"$\\gamma_3$",
"$\\beta_{intercept}$",
"$\\beta_{treatment}$",
"$\\beta_{time}$",
"$\\beta_{[age\\ge 3]}$",
"$\\beta_{log(dpp)}$",
"$\\beta_{[Hunt= M]}$",
"$\\beta_{[Hunt = W]}$",
"$R_{22}$",
"$\\Sigma_{\\alpha 33}$",
"$\\frac{\\Sigma_{\\alpha 34}}{\\sqrt{\\Sigma_{\\alpha 33}\\Sigma_{\\alpha 44}}}$",
"$\\Sigma_{\\alpha 44}$",
"$\\frac{R_{12}}{\\sqrt{R_{11}R_{22}}}$",
"$\\frac{\\Sigma_{\\alpha 13}}{\\sqrt{\\Sigma_{\\alpha 11}\\Sigma_{\\alpha 33}}}$",
"$\\frac{\\Sigma_{\\alpha 14}}{\\sqrt{\\Sigma_{\\alpha 11}\\Sigma_{\\alpha 44}}}$",
"$\\frac{\\Sigma_{\\alpha 23}}{\\sqrt{\\Sigma_{\\alpha 22}\\Sigma_{\\alpha 33}}}$",
"$\\frac{\\Sigma_{\\alpha 24}}{\\sqrt{\\Sigma_{\\alpha 22}\\Sigma_{\\alpha 44}}}$"),
priors = c("$N(\\mathbf{0}, \\mathbf{R}, 10^5\\mathbf{I})$", rep("", 6),
"$IW(\\mathbf{I}, 4)$",
"$SIW(\\mathbf{I}, 5, 0.2, 5)$", rep("", 2),
"$U(-1, 1)$",
"$U(0, 10^4)$",
rep("", 16)),
rbind(
## Ordinal
mcmc_summ(full_mod$res_beta[1,]),
mcmc_summ(full_mod$res_beta[2,]),
mcmc_summ(full_mod$res_beta[3,]),
mcmc_summ(full_mod$res_beta[4,]),
mcmc_summ(full_mod$res_beta[5,]),
mcmc_summ(full_mod$res_beta[6,]),
mcmc_summ(full_mod$res_beta[7,]),
mcmc_summ(full_mod$res_sigma[1,]),
mcmc_summ(full_mod$res_pat_sig[1,]),
mcmc_summ(full_mod$res_pat_sig[2,] / sqrt(full_mod$res_pat_sig[1,]) / sqrt(full_mod$res_pat_sig[6,])),
mcmc_summ(full_mod$res_pat_sig[6,]),
mcmc_summ(full_mod$res_ar),
mcmc_summ(full_mod$res_cuts[4, ]),
## Continuous
mcmc_summ(full_mod$res_beta[8,]),
mcmc_summ(full_mod$res_beta[9,]),
mcmc_summ(full_mod$res_beta[10,]),
mcmc_summ(full_mod$res_beta[11,]),
mcmc_summ(full_mod$res_beta[12,]),
mcmc_summ(full_mod$res_beta[13,]),
mcmc_summ(full_mod$res_beta[14,]),
mcmc_summ(full_mod$res_sigma[4,]),
mcmc_summ(full_mod$res_pat_sig[11,]),
mcmc_summ(full_mod$res_pat_sig[12,] / sqrt(full_mod$res_pat_sig[11,]) / sqrt(full_mod$res_pat_sig[16,])),
mcmc_summ(full_mod$res_pat_sig[16,]),
## Shared
mcmc_summ(full_mod$res_sigma[2,] / sqrt(full_mod$res_sigma[1,] * full_mod$res_sigma[4,])),
mcmc_summ(full_mod$res_pat_sig[3,] / sqrt(full_mod$res_pat_sig[1,]) / sqrt(full_mod$res_pat_sig[11,])),
mcmc_summ(full_mod$res_pat_sig[4,] / sqrt(full_mod$res_pat_sig[1,]) / sqrt(full_mod$res_pat_sig[16,])),
mcmc_summ(full_mod$res_pat_sig[7,] / sqrt(full_mod$res_pat_sig[6,]) / sqrt(full_mod$res_pat_sig[11,])),
mcmc_summ(full_mod$res_pat_sig[8,] / sqrt(full_mod$res_pat_sig[6,]) / sqrt(full_mod$res_pat_sig[16,]))))
print(xtable(df_tab[c(12:13, 1:7, 14:20, 8, 25, 21, 9:10, 26:27, 11, 28:29, 22, 23:24), c(2, 3, 1, 4, 5)], type = "latex"),
include.rownames = F, include.colnames = F, sanitize.text.function = identity,
hline.after = c(1:2, 16, 19))
View(df_tab)
## Collect objects
max_mod <- 4
mod_list <- list()
obs <- c(1:max_mod)
obs <- c(1:4)
for(i in 1:length(obs)){
mod_list[[i]] <- readRDS(paste0("Z:\\final_bmrarm\\bmrarm_samples\\ar_model_same_data", obs[i], ".RDS"))
mod_list[[i]]$samps <- mod_list[[i]]$samps$draws
#mod_list[[i]]$samps$res_pat_sig <- mod_list[[i]]$samps$res_pat_sig_q
print(mod_list[[i]]$runtime)
#print(effectiveSize(mcmc(mod_list[[i]]$samps$res_cuts[4, ])))
}
mcmc_summ <- function(x) {
summ <- summary(mcmc(x))
c(summ[[1]][1], summ[[1]][2], summ[[2]][1], summ[[2]][5],effectiveSize(mcmc(x)))
}
gamma3 <- t(sapply(1:4, function(x) mcmc_summ(mod_list[[x]]$samps$res_cuts[4, ])))
gamma4 <- t(sapply(1:4, function(x) mcmc_summ(mod_list[[x]]$samps$res_cuts[5, ])))
sig11 <- t(sapply(1:4, function(x) mcmc_summ(mod_list[[x]]$samps$res_sigma[1, ])))
sig_alpha11 <- t(sapply(1:4, function(x) mcmc_summ(mod_list[[x]]$samps$res_pat_sig[1, ])))
sig_alpha22 <- t(sapply(1:4, function(x) mcmc_summ(mod_list[[x]]$samps$res_pat_sig[6, ])))
full_tab_res <- rbind(gamma3, gamma4, sig11, sig_alpha11, sig_alpha22)
df <- data.frame(param = c("gamma3", rep("", 3), "gamm4", rep("", 3),
"sig11", rep("", 3), "sig_alpha11", rep("", 3),
"sig_alpha22", rep("", 3)),
chain = rep(1:4, 5), full_tab_res,
gelman_rubin = c("1.010", rep("", 3), "1.015", rep("", 3),
"1.008", rep("", 3), "1.006", rep("", 3),
"1.012", rep("", 3)))
print(xtable(df, type = "latex", digits = c(1, 1, 1, 2, 3, 2, 2, 2, 1)),
include.rownames = F, include.colnames = F)
View(df_tab)
View(df)
i <- 151
j <- 151
start <- (j - 1) * 2 + 1
end <- j * 2
end
start <- (j - 1) * 2 + 1
end <- j * 2
start <- (j - 1) * 2 + 1
end <- j * 2
end
start
j <- 170
start <- (j - 1) * 2 + 1
end <- j * 2
end
