lines(density(mcmc(mod_list[[3]]$samps$res_cuts[5, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_cuts[5, ])), col = 4, lwd = 3)
lines(density(mcmc(mod_list[[5]]$samps$res_cuts[5, ])), col = 5, lwd = 3)
lines(density(mcmc(mod_list[[6]]$samps$res_cuts[5, ])), col = 6, lwd = 3)
# Trace and density plots -------------------------------------------------
par(mfrow=c(1,1))
plot(mod_list[[1]]$samps$res_cuts[5, ], type = "l",
ylab = expression(gamma[3]), main = expression("Traceplot: " ~ gamma[3]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_cuts[5, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_cuts[5, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_cuts[5, ]), col = 4)
lines(mcmc(mod_list[[5]]$samps$res_cuts[5, ]), col = 5)
lines(mcmc(mod_list[[6]]$samps$res_cuts[5, ]), col = 6)
plot(density(mod_list[[1]]$samps$res_cuts[5, ]), type = "l", lwd = 3,
ylab = expression(gamma[3]), ylim = c(0, max_dens),
main = expression("Posterior Density: " ~ gamma[3]))
lines(density(mcmc(mod_list[[2]]$samps$res_cuts[5, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_cuts[5, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_cuts[5, ])), col = 4, lwd = 3)
lines(density(mcmc(mod_list[[5]]$samps$res_cuts[5, ])), col = 5, lwd = 3)
lines(density(mcmc(mod_list[[6]]$samps$res_cuts[5, ])), col = 6, lwd = 3)
plot(density(mod_list[[1]]$samps$res_cuts[5, ]), type = "l", lwd = 3,
ylab = expression(gamma[3]), ylim = c(0, max_dens),
main = expression("Posterior Density: " ~ gamma[3]))
lines(density(mcmc(mod_list[[2]]$samps$res_cuts[5, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_cuts[5, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_cuts[5, ])), col = 4, lwd = 3)
par(mfrow=c(2,2))
plot(mod_list[[1]]$samps$res_cuts[4, ], type = "l",
ylab = expression(gamma[3]), main = expression("Traceplot: " ~ gamma[3]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_cuts[4, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_cuts[4, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_cuts[4, ]), col = 4)
max_dens <- max(c(density(mod_list[[1]]$samps$res_cuts[4, ])$y,
density(mod_list[[2]]$samps$res_cuts[4, ])$y,
density(mod_list[[3]]$samps$res_cuts[4, ])$y))
plot(density(mod_list[[1]]$samps$res_cuts[4, ]), type = "l", lwd = 3,
ylab = expression(gamma[3]), ylim = c(0, max_dens),
main = expression("Posterior Density: " ~ gamma[3]))
lines(density(mcmc(mod_list[[2]]$samps$res_cuts[4, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_cuts[4, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_cuts[4, ])), col = 4, lwd = 3)
plot(mod_list[[1]]$samps$res_cuts[5, ], type = "l",
ylab = expression(gamma[3]), main = expression("Traceplot: " ~ gamma[3]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_cuts[5, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_cuts[5, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_cuts[5, ]), col = 4)
max_dens <- max(c(density(mod_list[[1]]$samps$res_cuts[5, ])$y,
density(mod_list[[2]]$samps$res_cuts[5, ])$y,
density(mod_list[[3]]$samps$res_cuts[5, ])$y))
plot(density(mod_list[[1]]$samps$res_cuts[5, ]), type = "l", lwd = 3,
ylab = expression(gamma[3]), ylim = c(0, max_dens),
main = expression("Posterior Density: " ~ gamma[4]))
lines(density(mcmc(mod_list[[2]]$samps$res_cuts[5, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_cuts[5, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_cuts[5, ])), col = 4, lwd = 3)
plot(mod_list[[1]]$samps$res_sigma[1, ], type = "l",
ylab = expression(Sigma[11]), main = expression("Traceplot: " ~ Sigma[11]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_sigma[1, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_sigma[1, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_sigma[1, ]), col = 4)
plot(density(mod_list[[1]]$samps$res_sigma[1, ]), type = "l", lwd = 3,
ylab = expression(Sigma[11]),
main = expression("Posterior Density: " ~ Sigma[11]))
lines(density(mcmc(mod_list[[2]]$samps$res_sigma[1, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_sigma[1, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_sigma[1, ])), col = 4, lwd = 3)
plot(mod_list[[1]]$samps$res_pat_sig[1, ], type = "l",
ylab = expression(Sigma[11]), main = expression("Traceplot: " ~ Sigma[11]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_pat_sig[1, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_pat_sig[1, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_pat_sig[1, ]), col = 4)
plot(density(mod_list[[1]]$samps$res_pat_sig[1, ]), type = "l", lwd = 3,
ylab = expression(Sigma[11]),
main = expression("Posterior Density: " ~ Sigma[11]))
lines(density(mcmc(mod_list[[2]]$samps$res_pat_sig[1, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_pat_sig[1, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_pat_sig[1, ])), col = 4, lwd = 3)
heidel.diag(mcmc.list(mcmc(mod_list[[1]]$samps$res_cuts[4, ]),
mcmc(mod_list[[2]]$samps$res_cuts[4, ]),
mcmc(mod_list[[3]]$samps$res_cuts[4, ]),
mcmc(mod_list[[4]]$samps$res_cuts[4, ])))
heidel.diag(mcmc.list(mcmc(mod_list[[1]]$samps$res_cuts[5, ]),
mcmc(mod_list[[2]]$samps$res_cuts[5, ]),
mcmc(mod_list[[3]]$samps$res_cuts[5, ]),
mcmc(mod_list[[4]]$samps$res_cuts[5, ])))
gelman.diag(mcmc.list(mcmc(mod_list[[1]]$samps$res_cuts[4, ]),
mcmc(mod_list[[2]]$samps$res_cuts[4, ]),
mcmc(mod_list[[3]]$samps$res_cuts[4, ]),
mcmc(mod_list[[4]]$samps$res_cuts[4, ])))
gelman.diag(mcmc.list(mcmc(mod_list[[1]]$samps$res_cuts[5, ]),
mcmc(mod_list[[2]]$samps$res_cuts[5, ]),
mcmc(mod_list[[3]]$samps$res_cuts[5, ]),
mcmc(mod_list[[4]]$samps$res_cuts[5, ])))
gelman.diag(mcmc.list(mcmc(mod_list[[1]]$samps$res_sigma[1, ]),
mcmc(mod_list[[2]]$samps$res_sigma[1, ]),
mcmc(mod_list[[3]]$samps$res_sigma[1, ]),
mcmc(mod_list[[4]]$samps$res_sigma[1, ])))
gelman.diag(mcmc.list(mcmc(mod_list[[1]]$samps$res_pat_sig[6, ]),
mcmc(mod_list[[2]]$samps$res_pat_sig[6, ]),
mcmc(mod_list[[3]]$samps$res_pat_sig[6, ]),
mcmc(mod_list[[4]]$samps$res_pat_sig[6, ])))
gelman.diag(mcmc.list(mcmc(mod_list[[1]]$samps$res_pat_sig[1, ]),
mcmc(mod_list[[2]]$samps$res_pat_sig[1, ]),
mcmc(mod_list[[3]]$samps$res_pat_sig[1, ]),
mcmc(mod_list[[4]]$samps$res_pat_sig[1, ])))
plot(density(mod_list[[1]]$samps$res_pat_sig[1, ]), type = "l", lwd = 3,
ylab = expression(Sigma[alpha][11]),
main = expression("Posterior Density: " ~ Sigma[11]))
main = expression("Posterior Density: " ~ expression(Sigma[alpha][11]))
)
plot(density(mod_list[[1]]$samps$res_pat_sig[1, ]), type = "l", lwd = 3,
ylab = expression(Sigma[alpha][11]),
main = expression("Posterior Density: " ~ Sigma[alpha][11]))
plot(density(mod_list[[1]]$samps$res_pat_sig[1, ]), type = "l", lwd = 3,
ylab = expression(Sigma[alpha][11]),
main = expression("Posterior Density: " ~ Sigma[alpha][11]))
lines(density(mcmc(mod_list[[2]]$samps$res_pat_sig[1, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_pat_sig[1, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_pat_sig[1, ])), col = 4, lwd = 3)
plot(mod_list[[1]]$samps$res_sigma[1, ], type = "l",
ylab = expression(Sigma[11]), main = expression("Traceplot: " ~ Sigma[11]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_sigma[1, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_sigma[1, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_sigma[1, ]), col = 4)
effectiveSize(mcmc(t(mod_list[[1]]$samps$res_cuts[4:5, ])))
effectiveSize(mcmc(t(mod_list[[2]]$samps$res_cuts[4:5, ])))
effectiveSize(mcmc(t(mod_list[[3]]$samps$res_cuts[4:5, ])))
effectiveSize(mcmc(t(mod_list[[4]]$samps$res_cuts[4:5, ])))
plot(mod_list[[1]]$samps$res_cuts[4, ], type = "l")
lines(mod_list[[2]]$samps$res_cuts[4, ], col = 2)
lines(mod_list[[3]]$samps$res_cuts[4, ], col = 3)
lines(mod_list[[4]]$samps$res_cuts[4, ], col = 4)
effectiveSize(mcmc(t(mod_list[[1]]$samps$res_cuts[4:5, ])))
effectiveSize(mcmc(t(mod_list[[2]]$samps$res_cuts[4:5, ])))
effectiveSize(mcmc(t(mod_list[[3]]$samps$res_cuts[4:5, ])))
effectiveSize(mcmc(t(mod_list[[4]]$samps$res_cuts[4:5, ])))
plot(mod_list[[1]]$samps$res_cuts[4, ], type = "l")
lines(mod_list[[2]]$samps$res_cuts[4, ], col = 2)
lines(mod_list[[3]]$samps$res_cuts[4, ], col = 3)
lines(mod_list[[4]]$samps$res_cuts[4, ], col = 4)
lines(mod_list[[5]]$samps$res_cuts[4, ], col = 5)
lines(mod_list[[6]]$samps$res_cuts[4, ], col = 6)
plot(mod_list[[1]]$samps$res_cuts[5, ], type = "l")
lines(mod_list[[2]]$samps$res_cuts[5, ], col = 2)
lines(mod_list[[3]]$samps$res_cuts[5, ], col = 3)
lines(mod_list[[4]]$samps$res_cuts[5, ], col = 4)
lines(mod_list[[5]]$samps$res_cuts[5, ], col = 5)
lines(mod_list[[6]]$samps$res_cuts[5, ], col = 6)
max_dens <- max(c(density(mod_list[[1]]$samps$res_cuts[5, ])$y,
density(mod_list[[2]]$samps$res_cuts[5, ])$y,
density(mod_list[[3]]$samps$res_cuts[5, ])$y))
plot(density(mod_list[[1]]$samps$res_cuts[5, ]), type = "l", lwd = 3,
ylab = expression(gamma[3]), ylim = c(0, max_dens),
main = expression("Posterior Density: " ~ gamma[4]))
lines(density(mcmc(mod_list[[2]]$samps$res_cuts[5, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_cuts[5, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_cuts[5, ])), col = 4, lwd = 3)
lines(density(mcmc(mod_list[[5]]$samps$res_cuts[5, ])), col = 5, lwd = 3)
lines(density(mcmc(mod_list[[6]]$samps$res_cuts[5, ])), col = 6, lwd = 3)
plot(mod_list[[1]]$samps$res_cuts[4, ], type = "l",
ylab = expression(gamma[3]), main = expression("Traceplot: " ~ gamma[3]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_cuts[4, ]), col = 2)
plot(mod_list[[1]]$samps$res_cuts[4, ], type = "l",
ylab = expression(gamma[3]), main = expression("Traceplot: " ~ gamma[3]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_cuts[4, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_cuts[4, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_cuts[4, ]), col = 4)
max_dens <- max(c(density(mod_list[[1]]$samps$res_cuts[4, ])$y,
density(mod_list[[2]]$samps$res_cuts[4, ])$y,
density(mod_list[[3]]$samps$res_cuts[4, ])$y))
plot(density(mod_list[[1]]$samps$res_cuts[4, ]), type = "l", lwd = 3,
ylab = expression(gamma[3]), ylim = c(0, max_dens),
main = expression("Posterior Density: " ~ gamma[3]))
lines(density(mcmc(mod_list[[2]]$samps$res_cuts[4, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_cuts[4, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_cuts[4, ])), col = 4, lwd = 3)
plot(mod_list[[1]]$samps$res_cuts[5, ], type = "l",
ylab = expression(gamma[3]), main = expression("Traceplot: " ~ gamma[3]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_cuts[5, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_cuts[5, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_cuts[5, ]), col = 4)
max_dens <- max(c(density(mod_list[[1]]$samps$res_cuts[5, ])$y,
density(mod_list[[2]]$samps$res_cuts[5, ])$y,
density(mod_list[[3]]$samps$res_cuts[5, ])$y))
plot(density(mod_list[[1]]$samps$res_cuts[5, ]), type = "l", lwd = 3,
ylab = expression(gamma[3]), ylim = c(0, max_dens),
main = expression("Posterior Density: " ~ gamma[4]))
plot(density(mod_list[[1]]$samps$res_cuts[5, ]), type = "l", lwd = 3,
ylab = expression(gamma[3]), ylim = c(0, max_dens),
main = expression("Posterior Density: " ~ gamma[4]))
lines(density(mcmc(mod_list[[2]]$samps$res_cuts[5, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_cuts[5, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_cuts[5, ])), col = 4, lwd = 3)
gelman.diag(mcmc.list(mcmc(t(mod_list[[1]]$samps$res_sigma)),
mcmc(t(mod_list[[2]]$samps$res_sigma)),
mcmc(t(mod_list[[3]]$samps$res_sigma)),
mcmc(t(mod_list[[4]]$samps$res_sigma))), multivariate = F)
gelman.diag(mcmc.list(mcmc(t(mod_list[[1]]$samps$res_pat_sig)),
mcmc(t(mod_list[[2]]$samps$res_pat_sig)),
mcmc(t(mod_list[[3]]$samps$res_pat_sig)),
mcmc(t(mod_list[[4]]$samps$res_pat_sig))), multivariate = F)
gelman.diag(mcmc.list(mcmc(t(mod_list[[1]]$samps$res_beta)),
mcmc(t(mod_list[[2]]$samps$res_beta)),
mcmc(t(mod_list[[3]]$samps$res_beta)),
mcmc(t(mod_list[[4]]$samps$res_beta))), multivariate = F)
gelman.diag(mcmc.list(mcmc(t(mod_list[[1]]$samps$res_pat_eff[,1,])),
mcmc(t(mod_list[[2]]$samps$res_pat_eff[,1,])),
mcmc(t(mod_list[[3]]$samps$res_pat_eff[,1,])),
mcmc(t(mod_list[[4]]$samps$res_pat_eff[,1,]))), multivariate = F)
gelman.diag(mcmc.list(mcmc(t(mod_list[[1]]$samps$res_pat_eff[,3,])),
mcmc(t(mod_list[[2]]$samps$res_pat_eff[,3,])),
mcmc(t(mod_list[[3]]$samps$res_pat_eff[,3,])),
mcmc(t(mod_list[[4]]$samps$res_pat_eff[,3,]))), multivariate = F)
summary(mcmc(t(mod_list[[1]]$samps$res_cuts)))
summary(mcmc(t(mod_list[[2]]$samps$res_cuts)))
summary(mcmc(t(mod_list[[2]]$samps$res_cuts)))[[2]]
summary(mcmc(t(mod_list[[2]]$samps$res_cuts)))[[2]][3, ]
summary(mcmc(t(mod_list[[2]]$samps$res_cuts)))[[2]][4, ]
summary(mcmc(t(mod_list[[2]]$samps$res_cuts)))[[2]][4, 3]
summary(mcmc(t(mod_list[[1]]$samps$res_cuts)))[[2]][4, 3]
summary(mcmc(t(mod_list[[1]]$samps$res_cuts)))[[2]][4, 3]
summary(mcmc(t(mod_list[[2]]$samps$res_cuts)))[[2]][4, 3]
summary(mcmc(t(mod_list[[3]]$samps$res_cuts)))[[2]][4, 3]
summary(mcmc(t(mod_list[[4]]$samps$res_cuts)))[[2]][4, 3]
summary(mcmc(t(mod_list[[4]]$samps$res_cuts)))[[2]][4:5, 3]
summary(mcmc(t(mod_list[[1]]$samps$res_cuts)))[[2]][4:5, 3]
summary(mcmc(t(mod_list[[2]]$samps$res_cuts)))[[2]][4:5, 3]
summary(mcmc(t(mod_list[[2]]$samps$res_cuts)))[[2]][4:5, 3]
summary(mcmc(t(mod_list[[3]]$samps$res_cuts)))[[2]][4:5, 3]
summary(mcmc(t(mod_list[[4]]$samps$res_cuts)))[[2]][4:5, 3]
summary(mcmc(t(mod_list[[1]]$samps$res_cuts)))[[2]][4:5, 3]
summary(mcmc(t(mod_list[[3]]$samps$res_cuts)))[[2]][4:5, 3]
summary(mcmc(t(mod_list[[1]]$samps$res_pat_sig)))
summary(mcmc(t(mod_list[[1]]$samps$res_pat_sig)))[[2]][c(1, 6, 11), 3]
summary(mcmc(t(mod_list[[2]]$samps$res_pat_sig)))[[2]][c(1, 6, 11), 3]
summary(mcmc(t(mod_list[[3]]$samps$res_pat_sig)))[[2]][c(1, 6, 11), 3]
summary(mcmc(t(mod_list[[4]]$samps$res_pat_sig)))[[2]][c(1, 6, 11), 3]
summary(mcmc(t(mod_list[[4]]$samps$res_sigma)))[[2]][, 3]
summary(mcmc(t(mod_list[[1]]$samps$res_sigma)))[[2]][, 3]
summary(mcmc(t(mod_list[[2]]$samps$res_sigma)))[[2]][, 3]
summary(mcmc(t(mod_list[[3]]$samps$res_sigma)))[[2]][, 3]
summary(mcmc(t(mod_list[[4]]$samps$res_sigma)))[[2]][, 3]
summary(mcmc(t(mod_list[[4]]$samps$res_sigma)))
summary(mcmc(t(mod_list[[4]]$samps$res_sigma)))[[1]][, 1]
summary(mcmc(t(mod_list[[1]]$samps$res_sigma)))[[1]][, 1]
summary(mcmc(t(mod_list[[2]]$samps$res_sigma)))[[1]][, 1]
summary(mcmc(t(mod_list[[3]]$samps$res_sigma)))[[1]][, 1]
summary(mcmc(t(mod_list[[3]]$samps$res_cuts)))[[2]][4:5, c(1, 3, 5)]
summary(mcmc(t(mod_list[[1]]$samps$res_cuts)))[[2]][4:5, c(1, 3, 5)]
summary(mcmc(t(mod_list[[2]]$samps$res_cuts)))[[2]][4:5, c(1, 3, 5)]
summary(mcmc(t(mod_list[[3]]$samps$res_cuts)))[[2]][4:5, c(1, 3, 5)]
summary(mcmc(t(mod_list[[4]]$samps$res_cuts)))[[2]][4:5, c(1, 3, 5)]
plot(mod_list[[1]]$samps$res_cuts[4, ], type = "l",
ylab = expression(gamma[3]), main = expression("Traceplot: " ~ gamma[3]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_cuts[4, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_cuts[4, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_cuts[4, ]), col = 4)
plot(mod_list[[1]]$samps$res_cuts[4, ], type = "l",
ylab = expression(gamma[3]), main = expression("Traceplot: " ~ gamma[3]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_cuts[4, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_cuts[4, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_cuts[4, ]), col = 4)
text(4000, 2.0, "Gelman-Rubin = 1.00")
text(3900, 2.0, "Gelman-Rubin = 1.00")
text(3750, 2.0, "Gelman-Rubin = 1.00")
plot(mod_list[[1]]$samps$res_cuts[4, ], type = "l",
ylab = expression(gamma[3]), main = expression("Traceplot: " ~ gamma[3]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_cuts[4, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_cuts[4, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_cuts[4, ]), col = 4)
text(3750, 2.0, "Gelman-Rubin = 1.00")
text(3750, 2.0, "GR Upper CI = 1.00")
plot(mod_list[[1]]$samps$res_cuts[4, ], type = "l",
ylab = expression(gamma[3]), main = expression("Traceplot: " ~ gamma[3]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_cuts[4, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_cuts[4, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_cuts[4, ]), col = 4)
text(3600, 2.0, "GR Upper CI = 1.00")
text(3600, 1.9, "GR Upper CI = 1.00", cex = 0.9)
text(3500, 1.95, "GR Upper CI = 1.00", cex = 1)
text(3400, 1.95, "GR Upper CI = 1.00", cex = 1)
plot(mod_list[[1]]$samps$res_cuts[4, ], type = "l",
ylab = expression(gamma[3]), main = expression("Traceplot: " ~ gamma[3]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_cuts[4, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_cuts[4, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_cuts[4, ]), col = 4)
text(3400, 1.97, "GR Upper CI = 1.00", cex = 1)
plot(mod_list[[1]]$samps$res_cuts[4, ], type = "l",
ylab = expression(gamma[3]), main = expression("Traceplot: " ~ gamma[3]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_cuts[4, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_cuts[4, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_cuts[4, ]), col = 4)
text(3400, 1.98, "GR Upper CI = 1.00", cex = 1)
plot(mod_list[[1]]$samps$res_cuts[4, ], type = "l",
ylab = expression(gamma[3]), main = expression("Traceplot: " ~ gamma[3]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_cuts[4, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_cuts[4, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_cuts[4, ]), col = 4)
text(3400, 1.99, "GR Upper CI = 1.00", cex = 1)
gelman.diag(mcmc.list(mcmc(mod_list[[1]]$samps$res_cuts[4, ]),
mcmc(mod_list[[2]]$samps$res_cuts[4, ]),
mcmc(mod_list[[3]]$samps$res_cuts[4, ]),
mcmc(mod_list[[4]]$samps$res_cuts[4, ])))
gelman.diag(mcmc.list(mcmc(mod_list[[1]]$samps$res_cuts[5, ]),
mcmc(mod_list[[2]]$samps$res_cuts[5, ]),
mcmc(mod_list[[3]]$samps$res_cuts[5, ]),
mcmc(mod_list[[4]]$samps$res_cuts[5, ])))
gelman.diag(mcmc.list(mcmc(mod_list[[1]]$samps$res_sigma[1, ]),
mcmc(mod_list[[2]]$samps$res_sigma[1, ]),
mcmc(mod_list[[3]]$samps$res_sigma[1, ]),
mcmc(mod_list[[4]]$samps$res_sigma[1, ])))
gelman.diag(mcmc.list(mcmc(mod_list[[1]]$samps$res_pat_sig[6, ]),
mcmc(mod_list[[2]]$samps$res_pat_sig[6, ]),
mcmc(mod_list[[3]]$samps$res_pat_sig[6, ]),
mcmc(mod_list[[4]]$samps$res_pat_sig[6, ])))
gelman.diag(mcmc.list(mcmc(mod_list[[1]]$samps$res_pat_sig[1, ]),
mcmc(mod_list[[2]]$samps$res_pat_sig[1, ]),
mcmc(mod_list[[3]]$samps$res_pat_sig[1, ]),
mcmc(mod_list[[4]]$samps$res_pat_sig[1, ])))
plot(mod_list[[1]]$samps$res_cuts[5, ], type = "l",
ylab = expression(gamma[3]), main = expression("Traceplot: " ~ gamma[3]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_cuts[5, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_cuts[5, ]), col = 3)
text(3400, 2.6, "GR Upper CI = 1.00", cex = 1)
plot(mod_list[[1]]$samps$res_sigma[1, ], type = "l",
ylab = expression(Sigma[11]), main = expression("Traceplot: " ~ Sigma[11]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_sigma[1, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_sigma[1, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_sigma[1, ]), col = 4)
text(3400, 0.78, "GR Upper CI = 1.01", cex = 1)
text(3400, 0.79, "GR Upper CI = 1.01", cex = 1)
plot(mod_list[[1]]$samps$res_pat_sig[1, ], type = "l",
ylab = expression(Sigma[11]), main = expression("Traceplot: " ~ Sigma[11]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_pat_sig[1, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_pat_sig[1, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_pat_sig[1, ]), col = 4)
text(3400, 0.6, "GR Upper CI = 1.00", cex = 1)
text(3400, 0.63, "GR Upper CI = 1.00", cex = 1)
gelman.diag(mcmc.list(mcmc(mod_list[[1]]$samps$res_pat_sig[1, ]),
mcmc(mod_list[[2]]$samps$res_pat_sig[1, ]),
mcmc(mod_list[[3]]$samps$res_pat_sig[1, ]),
mcmc(mod_list[[4]]$samps$res_pat_sig[1, ])))
gelman.diag(mcmc.list(mcmc(mod_list[[1]]$samps$res_pat_sig[6, ]),
mcmc(mod_list[[2]]$samps$res_pat_sig[6, ]),
mcmc(mod_list[[3]]$samps$res_pat_sig[6, ]),
mcmc(mod_list[[4]]$samps$res_pat_sig[6, ])))
gelman.diag(mcmc.list(mcmc(mod_list[[1]]$samps$res_pat_sig[11, ]),
mcmc(mod_list[[2]]$samps$res_pat_sig[11, ]),
mcmc(mod_list[[3]]$samps$res_pat_sig[11, ]),
mcmc(mod_list[[4]]$samps$res_pat_sig[11, ])))
gelman.diag(mcmc.list(mcmc(mod_list[[1]]$samps$res_sigma[1, ]),
mcmc(mod_list[[2]]$samps$res_sigma[1, ]),
mcmc(mod_list[[3]]$samps$res_sigma[1, ]),
mcmc(mod_list[[4]]$samps$res_sigma[1, ])))
summary(mcmc(t(mod_list[[3]]$samps$res_sigma)))
# Make table of posterior estimates ---------------------------------------
mcmc_summ <- function(x) {
summ <- summary(mcmc(x))
c(summ[[2]][1, 3], summ[[1]][1, 2], summ[[2]][1, 1], summ[[2]][1, 5],
effectiveSize(mcmc(x)))
}
mcmc_summ(mod_list[[4]]$samps$res_cuts[4, ])
x <- mcmc_summ(mod_list[[4]]$samps$res_cuts[4, ])
summ <- summary(mcmc(x))
summ[[2]]
x <- mcmc_summ(mod_list[[4]]$samps$res_cuts[4, ])
x <-mod_list[[4]]$samps$res_cuts[4, ]
summ[[2]]
summ <- summary(mcmc(x))
summ[[2]]
summ <- summary(mcmc(x))
c(summ[[2]][3], summ[[1]][2], summ[[2]][1], summ[[2]][5],
effectiveSize(mcmc(x)))
# Make table of posterior estimates ---------------------------------------
mcmc_summ <- function(x) {
summ <- summary(mcmc(x))
c(summ[[2]][3], summ[[1]][2], summ[[2]][1], summ[[2]][5],effectiveSize(mcmc(x)))
}
mcmc_summ(mod_list[[4]]$samps$res_cuts[4, ])
gamma1 <- sapply(1:4, function(x) {
mcmc_summ(mod_list[[x]]$samps$res_cuts[4, ])
}
)
gamma1
gamma1 <- sapply(1:4, function(x) {
t(mcmc_summ(mod_list[[x]]$samps$res_cuts[4, ]))
}
)
gamma1
gamma1 <- sapply(1:4, function(x) mcmc_summ(mod_list[[x]]$samps$res_cuts[4, ]))
gamma3 <- t(sapply(1:4, function(x) mcmc_summ(mod_list[[x]]$samps$res_cuts[4, ])))
gamma3
gamma3 <- t(sapply(1:4, function(x) mcmc_summ(mod_list[[x]]$samps$res_cuts[4, ])))
gamma4 <- t(sapply(1:4, function(x) mcmc_summ(mod_list[[x]]$samps$res_cuts[5, ])))
sig11 <- t(sapply(1:4, function(x) mcmc_summ(mod_list[[x]]$samps$res_sigma[1, ])))
sig_alpha11 <- t(sapply(1:4, function(x) mcmc_summ(mod_list[[x]]$samps$res_pat_sig[1, ])))
sig_alpha11
gamma3
full_tab_res <- rbind(gamma3, gamma4, sig11, sig_alpha11)
full_tab_res
rep(c("gamma3", "gamma4", "sig11", "sig_alpha11"), each = 4)
cbind(rep(c("gamma3", "gamma4", "sig11", "sig_alpha11"), each = 4),
rep(1:4, 4))
full_tab_res
data.frame(param = rep(c("gamma3", "gamma4", "sig11", "sig_alpha11"), each = 4),
chain = rep(1:4, 4))
data.frame(param = rep(c("gamma3", "gamma4", "sig11", "sig_alpha11"), each = 4),
chain = rep(1:4, 4), full_tab_res)
df <- data.frame(param = rep(c("gamma3", "gamma4", "sig11", "sig_alpha11"), each = 4),
chain = rep(1:4, 4), full_tab_res)
library(xtable)
print(xtable(df, type = "latex", digits = c(1, 1, 2, 3, 2, 2, 2)),
include.rownames = F, include.colnames = F)
print(xtable(df, type = "latex", digits = c(1, 1, 1, 2, 3, 2, 2, 2)),
include.rownames = F, include.colnames = F)
xtable(df, type = "latex", digits = c(1, 1, 1, 2, 3, 2, 2, 2))
df <- data.frame(param = rep(c("gamma3", "gamma4", "sig11", "sig_alpha11"), each = 4),
chain = rep(1:4, 4), full_tab_res,
gelman_rubin = c("1.00", rep("", 3), "1.00", rep("", 3),
"1.01", rep("", 3), "1.00", rep("", 3)))
print(xtable(df, type = "latex", digits = c(1, 1, 1, 2, 3, 2, 2, 2, 1)),
include.rownames = F, include.colnames = F)
df <- data.frame(param = c("gamma3", rep("", 3), "gamm4", rep("", 3),
"sig11", rep("", 3), "sig_alpha11", rep("", 3)),
chain = rep(1:4, 4), full_tab_res,
gelman_rubin = c("1.00", rep("", 3), "1.00", rep("", 3),
"1.01", rep("", 3), "1.00", rep("", 3)))
print(xtable(df, type = "latex", digits = c(1, 1, 1, 2, 3, 2, 2, 2, 1)),
include.rownames = F, include.colnames = F)
print(xtable(df, type = "latex", digits = c(1, 1, 1, 2, 4, 2, 2, 2, 1)),
include.rownames = F, include.colnames = F)
print(xtable(df, type = "latex", digits = c(1, 1, 1, 2, 3, 2, 2, 2, 1)),
include.rownames = F, include.colnames = F)
par(mfrow=c(2,2))
plot(mod_list[[1]]$samps$res_cuts[4, ], type = "l",
ylab = expression(gamma[3]), main = expression("Traceplot: " ~ gamma[3]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_cuts[4, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_cuts[4, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_cuts[4, ]), col = 4)
text(3400, 1.99, "GR Upper CI = 1.00", cex = 1)
max_dens <- max(c(density(mod_list[[1]]$samps$res_cuts[4, ])$y,
density(mod_list[[2]]$samps$res_cuts[4, ])$y,
density(mod_list[[3]]$samps$res_cuts[4, ])$y))
plot(density(mod_list[[1]]$samps$res_cuts[4, ]), type = "l", lwd = 3,
ylab = expression(gamma[3]), ylim = c(0, max_dens),
main = expression("Posterior Density: " ~ gamma[3]))
lines(density(mcmc(mod_list[[2]]$samps$res_cuts[4, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_cuts[4, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_cuts[4, ])), col = 4, lwd = 3)
plot(mod_list[[1]]$samps$res_cuts[5, ], type = "l",
ylab = expression(gamma[3]), main = expression("Traceplot: " ~ gamma[3]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_cuts[5, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_cuts[5, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_cuts[5, ]), col = 4)
text(3400, 2.6, "GR Upper CI = 1.00", cex = 1)
max_dens <- max(c(density(mod_list[[1]]$samps$res_cuts[5, ])$y,
density(mod_list[[2]]$samps$res_cuts[5, ])$y,
density(mod_list[[3]]$samps$res_cuts[5, ])$y))
plot(density(mod_list[[1]]$samps$res_cuts[5, ]), type = "l", lwd = 3,
ylab = expression(gamma[3]), ylim = c(0, max_dens),
main = expression("Posterior Density: " ~ gamma[4]))
lines(density(mcmc(mod_list[[2]]$samps$res_cuts[5, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_cuts[5, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_cuts[5, ])), col = 4, lwd = 3)
plot(mod_list[[1]]$samps$res_sigma[1, ], type = "l",
ylab = expression(Sigma[11]), main = expression("Traceplot: " ~ Sigma[11]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_sigma[1, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_sigma[1, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_sigma[1, ]), col = 4)
text(3400, 0.79, "GR Upper CI = 1.01", cex = 1)
plot(density(mod_list[[1]]$samps$res_sigma[1, ]), type = "l", lwd = 3,
ylab = expression(Sigma[11]),
main = expression("Posterior Density: " ~ Sigma[11]))
lines(density(mcmc(mod_list[[2]]$samps$res_sigma[1, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_sigma[1, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_sigma[1, ])), col = 4, lwd = 3)
plot(mod_list[[1]]$samps$res_pat_sig[1, ], type = "l",
ylab = expression(Sigma[11]), main = expression("Traceplot: " ~ Sigma[11]),
xlab = "Iterations")
lines(mcmc(mod_list[[2]]$samps$res_pat_sig[1, ]), col = 2)
lines(mcmc(mod_list[[3]]$samps$res_pat_sig[1, ]), col = 3)
lines(mcmc(mod_list[[4]]$samps$res_pat_sig[1, ]), col = 4)
text(3400, 0.63, "GR Upper CI = 1.00", cex = 1)
plot(density(mod_list[[1]]$samps$res_pat_sig[1, ]), type = "l", lwd = 3,
ylab = expression(Sigma[alpha][11]),
main = expression("Posterior Density: " ~ Sigma[alpha][11]))
lines(density(mcmc(mod_list[[2]]$samps$res_pat_sig[1, ])), col = 2, lwd = 3)
lines(density(mcmc(mod_list[[3]]$samps$res_pat_sig[1, ])), col = 3, lwd = 3)
lines(density(mcmc(mod_list[[4]]$samps$res_pat_sig[1, ])), col = 4, lwd = 3)
